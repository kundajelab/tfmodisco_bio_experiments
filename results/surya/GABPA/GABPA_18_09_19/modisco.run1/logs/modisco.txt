2018-09-20 14:17:23 INFO  /home/ktian/kundajelab/tfnet//scripts/run_tfmodisco.py --scores scores/hyp_scores_task_ --fasta interpret.fa --tsv interpret.tsv --start-task 0 --end-task 10 --fdr 0.01
2018-09-20 14:17:23 DEBUG Theano version:1.0.2
2018-09-20 14:17:23 DEBUG 2.7.13 |Continuum Analytics, Inc.| (default, Dec 20 2016, 23:09:15) 
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]
2018-09-20 14:17:23 DEBUG method file prefix is scores/hyp_scores_task_, input seq file is interpret.fa, input tsv is interpret.tsv, start_task is 0 end_task is 10, fdr is 0.010000
2018-09-20 14:17:24 DEBUG lenth of sequences = 109162
2018-09-20 14:17:28 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:17:35 DEBUG shape of hyp_score (476, 4)
2018-09-20 14:17:35 DEBUG shape of score (476, 4)
2018-09-20 14:17:40 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:17:51 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:02 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:13 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:24 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:36 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:47 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:18:59 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
2018-09-20 14:19:10 DEBUG merged overlaps based on in_tsv interpret.tsv, 109162 seqs merged into 43651 seqs, max len 3241
On task task0
Computing windowed sums
Computing threshold
2018-09-20 14:21:17 DEBUG CACHEDIR=/home/ktian/.cache/matplotlib
2018-09-20 14:21:17 DEBUG Using fontManager instance from /home/ktian/.cache/matplotlib/fontList.json
2018-09-20 14:21:17 DEBUG backend agg version v2.2
2018-09-20 14:21:18 DEBUG findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=10.0 to DejaVu Sans (u'/home/ktian/anaconda2/envs/modisco_dev/lib/python2.7/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000
peak(mu)= -0.40379343612105
Manually adjusting thresholds to get desired num seqlets
Mu: -4.037934e-01 +/- 4.947046e-06
Lablace_b: 0.47849906506590273 and 0.49382907684050875
Thresholds: -3.738733041074725 and 2.9311461688326252
#fdrs pass: 0 and 0
CDFs: 0.9990599564650748 and 0.9988328921266011
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_0.png
Got 1103 coords
On task task1
Computing windowed sums
Computing threshold
peak(mu)= 0.1919075678305437
Manually adjusting thresholds to get desired num seqlets
Mu: 1.919076e-01 +/- 6.691323e-06
Lablace_b: 0.43929483453114787 and 0.7920491226543553
Thresholds: -6.5679572859373465 and 6.9517724215984344
#fdrs pass: 0 and 0
CDFs: 0.9999997924701719 and 0.9998034617613052
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_1.png
Got 1279 coords
On task task2
Computing windowed sums
Computing threshold
peak(mu)= 0.11075651799781189
Manually adjusting thresholds to get desired num seqlets
Mu: 1.107565e-01 +/- 5.900985e-06
Lablace_b: 0.4644598405305568 and 0.6789226069349374
Thresholds: -4.32416783113408 and 4.545680867129704
#fdrs pass: 0 and 0
CDFs: 0.9999286963933559 and 0.9985443421564889
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_2.png
Got 1353 coords
On task task3
Computing windowed sums
Computing threshold
peak(mu)= 0.46416420637592115
Manually adjusting thresholds to get desired num seqlets
Mu: 4.641642e-01 +/- 5.600713e-06
Lablace_b: 0.6250199614680504 and 0.8544069176601451
Thresholds: -3.7001185513227988 and 4.628446964074641
#fdrs pass: 0 and 0
CDFs: 0.9987222309080919 and 0.992356403092097
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_3.png
Got 1471 coords
On task task4
Computing windowed sums
Computing threshold
peak(mu)= 0.30948020940460264
Manually adjusting thresholds to get desired num seqlets
Mu: 3.094802e-01 +/- 6.156581e-06
Lablace_b: 0.48173382478989935 and 0.6846161725856023
Thresholds: -5.46845861377567 and 6.087419032584876
#fdrs pass: 0 and 0
CDFs: 0.9999938191108808 and 0.9997838798830176
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_4.png
Got 1271 coords
On task task5
Computing windowed sums
Computing threshold
peak(mu)= 0.25371881857793777
Manually adjusting thresholds to get desired num seqlets
Mu: 2.537188e-01 +/- 4.886364e-06
Lablace_b: 0.43774178988054824 and 0.5694156026408103
Thresholds: -3.817865183002082 and 4.325302820157958
#fdrs pass: 0 and 0
CDFs: 0.9999086979408397 and 0.9992154975778801
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_5.png
Got 1303 coords
On task task6
Computing windowed sums
Computing threshold
peak(mu)= 0.15426114456204248
Manually adjusting thresholds to get desired num seqlets
Mu: 1.542611e-01 +/- 7.616162e-06
Lablace_b: 0.5231695182686968 and 0.6828258848474492
Thresholds: -6.973141105787363 and 7.2816633949114475
#fdrs pass: 0 and 0
CDFs: 0.9999987883220592 and 0.9999707050720821
Est. FDRs: 1.0 and 0.2697959103289829
saving plot to figures/laplace_6.png
Got 1302 coords
On task task7
Computing windowed sums
Computing threshold
peak(mu)= 0.3502712035179866
Manually adjusting thresholds to get desired num seqlets
Mu: 3.502712e-01 +/- 6.257716e-06
Lablace_b: 0.44003630343755373 and 0.8188320246011622
Thresholds: -5.381511053610447 and 6.082053460646421
#fdrs pass: 0 and 0
CDFs: 0.9999977970278561 and 0.9990880713550504
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_7.png
Got 1354 coords
On task task8
Computing windowed sums
Computing threshold
peak(mu)= 0.3112393255693896
Manually adjusting thresholds to get desired num seqlets
Mu: 3.112393e-01 +/- 7.891285e-06
Lablace_b: 0.70968268588979 and 0.8664173856099157
Thresholds: -6.563262575981382 and 7.185741227120161
#fdrs pass: 0 and 0
CDFs: 0.999937897620253 and 0.9996417930857984
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_8.png
Got 1250 coords
On task task9
Computing windowed sums
Computing threshold
peak(mu)= -0.10169599346563357
Manually adjusting thresholds to get desired num seqlets
Mu: -1.016960e-01 +/- 7.163406e-06
Lablace_b: 0.6301945137457471 and 0.6407961447089606
Thresholds: -6.582308072046901 and 6.378916085115634
#fdrs pass: 0 and 0
CDFs: 0.9999658077239102 and 0.9999594662490942
Est. FDRs: 1.0 and 0.8134747657645789
saving plot to figures/laplace_9.png
Got 1246 coords
After resolving overlaps, got 4368 seqlets
Across all tasks, the weakest laplace threshold used was: 0.992356403092097
 identified in total
 activity patterns with support >= 100 out of 59049 possible patterns
Metacluster sizes:  [860, 672, 650, 315, 309, 294, 254, 167, 147, 135]
Idx to activities:  {0: '0,0,1,0,0,0,0,0,0,0', 1: '1,1,1,0,1,1,1,1,1,1', 2: '1,1,1,1,1,1,1,1,1,1', 3: '1,1,0,0,1,1,1,1,1,1', 4: '0,0,0,1,0,0,0,0,0,0', 5: '0,1,0,0,1,1,1,1,1,1', 6: '0,1,1,0,1,1,1,1,1,1', 7: '0,1,0,1,1,1,1,1,1,1', 8: '0,1,1,1,1,1,1,1,1,1', 9: '1,1,0,1,1,1,1,1,1,1'}
On metacluster 9
Metacluster size 135
Relevant tasks:  ('task0', 'task1', 'task3', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 135
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 2.56 s
Starting affinity matrix computations
Normalization computed in 0.1 s
Cosine similarity mat computed in 0.15 s
Normalization computed in 0.08 s
Cosine similarity mat computed in 0.14 s
Finished affinity matrix computations in 0.29 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 14.31 s
Launching nearest neighbors affmat calculation job
Job completed in: 8.8 s
(Round 1) Computed affinity matrix on nearest neighbors in 23.67 s
Filtered down to 135 of 135
(Round 1) Retained 135 rows out of 135 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 135 samples in 0.000s...
[t-SNE] Computed neighbors for 135 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 135 / 135
[t-SNE] Mean sigma: 0.199618
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0216479301453 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.7s finished
Louvain completed 200 runs in 1.23024606705 seconds
Wrote graph to binary file in 0.0247979164124 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.620141
After 22 runs, maximum modularity is Q = 0.625891
Louvain completed 72 runs in 45.046820879 seconds
Preproc + Louvain took 46.3524839878 s
Got 6 clusters after round 1
Counts:
{0: 35, 1: 33, 2: 27, 3: 20, 4: 13, 5: 7}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 35 seqlets
Trimmed 2 out of 35
Aggregating for cluster 1 with 33 seqlets
Trimmed 0 out of 33
Aggregating for cluster 2 with 27 seqlets
Trimmed 2 out of 27
Aggregating for cluster 3 with 20 seqlets
Trimmed 0 out of 20
Aggregating for cluster 4 with 13 seqlets
Trimmed 0 out of 13
Aggregating for cluster 5 with 7 seqlets
Trimmed 0 out of 7
(Round 2) num seqlets: 131
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 2.67 s
Starting affinity matrix computations
Normalization computed in 0.09 s
Cosine similarity mat computed in 0.14 s
Normalization computed in 0.08 s
Cosine similarity mat computed in 0.13 s
Finished affinity matrix computations in 0.28 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 12.76 s
Launching nearest neighbors affmat calculation job
Job completed in: 12.83 s
(Round 2) Computed affinity matrix on nearest neighbors in 26.15 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 131 samples in 0.000s...
[t-SNE] Computed neighbors for 131 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 131 / 131
[t-SNE] Mean sigma: 0.193446
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0180468559265 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.7s finished
Louvain completed 200 runs in 1.22766184807 seconds
Wrote graph to binary file in 0.0236761569977 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.580573
After 2 runs, maximum modularity is Q = 0.584814
Louvain completed 52 runs in 33.8146438599 seconds
Preproc + Louvain took 35.1332759857 s
Got 7 clusters after round 2
Counts:
{0: 43, 1: 33, 2: 18, 3: 13, 4: 12, 5: 8, 6: 4}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 43 seqlets
Trimmed 2 out of 43
Aggregating for cluster 1 with 33 seqlets
Trimmed 0 out of 33
Aggregating for cluster 2 with 18 seqlets
Trimmed 0 out of 18
Aggregating for cluster 3 with 13 seqlets
Trimmed 0 out of 13
Aggregating for cluster 4 with 12 seqlets
Trimmed 0 out of 12
Aggregating for cluster 5 with 8 seqlets
Trimmed 0 out of 8
Aggregating for cluster 6 with 4 seqlets
Trimmed 0 out of 4
Got 7 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00257301330566 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = -0.000216733
After 3 runs, maximum modularity is Q = -0.000202022
After 5 runs, maximum modularity is Q = 3.76314e-05
After 6 runs, maximum modularity is Q = 3.76407e-05
After 8 runs, maximum modularity is Q = 7.6758e-05
After 16 runs, maximum modularity is Q = 7.67623e-05
Louvain completed 36 runs in 25.091135025 seconds
Similarity is 0.9502975061115061; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0052502155304 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000759719
After 2 runs, maximum modularity is Q = 0.000759722
After 4 runs, maximum modularity is Q = 0.000759723
After 14 runs, maximum modularity is Q = 0.000759725
After 17 runs, maximum modularity is Q = 0.000759726
Louvain completed 37 runs in 25.7103381157 seconds
Similarity is 0.9401973225410419; is_dissimilar is False
Merging on 7 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 2 with prob 1.4797783134756613e-06 and sim 8.749253306756277
Collapsing 0 & 1 with prob 3.1762272463044145e-06 and sim 8.34750055063745
Trimmed 0 out of 59
Trimmed 0 out of 92
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 5 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 0.17 s
Cross contin jaccard time taken: 0.17 s
Got 1 patterns after reassignment
Total time taken is 208.19s
On metacluster 8
Metacluster size 147
Relevant tasks:  ('task1', 'task2', 'task3', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 147
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 2.43 s
Starting affinity matrix computations
Normalization computed in 0.09 s
Cosine similarity mat computed in 0.16 s
Normalization computed in 0.09 s
Cosine similarity mat computed in 0.16 s
Finished affinity matrix computations in 0.32 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 8.79 s
Launching nearest neighbors affmat calculation job
Job completed in: 9.04 s
(Round 1) Computed affinity matrix on nearest neighbors in 18.43 s
Filtered down to 146 of 147
(Round 1) Retained 146 rows out of 147 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 146 samples in 0.000s...
[t-SNE] Computed neighbors for 146 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 146 / 146
[t-SNE] Mean sigma: 0.209880
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0185170173645 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.38572120667 seconds
Wrote graph to binary file in 0.0414509773254 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.621504
After 4 runs, maximum modularity is Q = 0.621836
Louvain completed 54 runs in 36.6008470058 seconds
Preproc + Louvain took 41.604434967 s
Got 3 clusters after round 1
Counts:
{0: 56, 1: 54, 2: 36}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 56 seqlets
Trimmed 1 out of 56
Aggregating for cluster 1 with 54 seqlets
Trimmed 2 out of 54
Aggregating for cluster 2 with 36 seqlets
Trimmed 1 out of 36
(Round 2) num seqlets: 142
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 2.97 s
Starting affinity matrix computations
Normalization computed in 0.09 s
Cosine similarity mat computed in 0.17 s
Normalization computed in 0.09 s
Cosine similarity mat computed in 0.15 s
Finished affinity matrix computations in 0.33 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 15.78 s
Launching nearest neighbors affmat calculation job
Job completed in: 15.73 s
(Round 2) Computed affinity matrix on nearest neighbors in 32.15 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 142 samples in 0.000s...
[t-SNE] Computed neighbors for 142 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 142 / 142
[t-SNE] Mean sigma: 0.204042
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0234100818634 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.8s finished
Louvain completed 200 runs in 1.38648605347 seconds
Wrote graph to binary file in 0.0360660552979 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.622981
Louvain completed 51 runs in 32.6306860447 seconds
Preproc + Louvain took 34.0955510139 s
Got 4 clusters after round 2
Counts:
{0: 50, 1: 47, 2: 34, 3: 11}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 50 seqlets
Trimmed 0 out of 50
Aggregating for cluster 1 with 47 seqlets
Trimmed 2 out of 47
Aggregating for cluster 2 with 34 seqlets
Trimmed 1 out of 34
Aggregating for cluster 3 with 11 seqlets
Trimmed 0 out of 11
Got 4 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00308418273926 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000491214
After 7 runs, maximum modularity is Q = 0.000491215
After 18 runs, maximum modularity is Q = 0.000491216
After 26 runs, maximum modularity is Q = 0.000491218
Louvain completed 46 runs in 33.0097820759 seconds
Similarity is 0.9613940762049443; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00869989395142 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000658774
After 2 runs, maximum modularity is Q = 0.00078484
After 10 runs, maximum modularity is Q = 0.000827969
After 13 runs, maximum modularity is Q = 0.000827972
Louvain completed 33 runs in 24.4586880207 seconds
Similarity is 0.9587805482860209; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00526905059814 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = -0.000653881
After 2 runs, maximum modularity is Q = -3.25498e-10
After 6 runs, maximum modularity is Q = 6.50996e-10
After 16 runs, maximum modularity is Q = 8.13745e-10
Louvain completed 36 runs in 24.8313701153 seconds
Merging on 4 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 2 with prob 0.00016684268015122324 and sim 8.856623513191986
Collapsing 1 & 2 with prob 2.1764595476015784e-05 and sim 7.8304782035467975
Trimmed 0 out of 83
Trimmed 0 out of 128
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 2 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 1.37 s
Cross contin jaccard time taken: 1.18 s
Got 1 patterns after reassignment
Total time taken is 233.16s
On metacluster 7
Metacluster size 167
Relevant tasks:  ('task1', 'task3', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 167
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 2.66 s
Starting affinity matrix computations
Normalization computed in 0.11 s
Cosine similarity mat computed in 0.18 s
Normalization computed in 0.1 s
Cosine similarity mat computed in 0.18 s
Finished affinity matrix computations in 0.37 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 10.48 s
Launching nearest neighbors affmat calculation job
Job completed in: 10.27 s
(Round 1) Computed affinity matrix on nearest neighbors in 21.43 s
Filtered down to 167 of 167
(Round 1) Retained 167 rows out of 167 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 167 samples in 0.000s...
[t-SNE] Computed neighbors for 167 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.208126
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0254778862 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.7s finished
Louvain completed 200 runs in 1.24505209923 seconds
Wrote graph to binary file in 0.0263149738312 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.718491
Louvain completed 51 runs in 35.3959281445 seconds
Preproc + Louvain took 36.7125191689 s
Got 4 clusters after round 1
Counts:
{0: 50, 1: 42, 2: 38, 3: 37}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 50 seqlets
Trimmed 1 out of 50
Aggregating for cluster 1 with 42 seqlets
Trimmed 2 out of 42
Aggregating for cluster 2 with 38 seqlets
Trimmed 2 out of 38
Aggregating for cluster 3 with 37 seqlets
Trimmed 0 out of 37
(Round 2) num seqlets: 162
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 3.67 s
Starting affinity matrix computations
Normalization computed in 0.11 s
Cosine similarity mat computed in 0.19 s
Normalization computed in 0.1 s
Cosine similarity mat computed in 0.17 s
Finished affinity matrix computations in 0.37 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 18.24 s
Launching nearest neighbors affmat calculation job
Job completed in: 17.96 s
(Round 2) Computed affinity matrix on nearest neighbors in 36.96 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 162 samples in 0.000s...
[t-SNE] Computed neighbors for 162 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 162 / 162
[t-SNE] Mean sigma: 0.197730
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.018522977829 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.40771389008 seconds
Wrote graph to binary file in 0.0305230617523 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.695515
After 7 runs, maximum modularity is Q = 0.697474
After 11 runs, maximum modularity is Q = 0.697858
Louvain completed 61 runs in 39.5117990971 seconds
Preproc + Louvain took 40.9788990021 s
Got 4 clusters after round 2
Counts:
{0: 46, 1: 45, 2: 38, 3: 33}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 46 seqlets
Trimmed 0 out of 46
Aggregating for cluster 1 with 45 seqlets
Trimmed 6 out of 45
Aggregating for cluster 2 with 38 seqlets
Trimmed 3 out of 38
Aggregating for cluster 3 with 33 seqlets
Trimmed 4 out of 33
Got 4 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.0023078918457 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00404442
Louvain completed 21 runs in 14.5108668804 seconds
Similarity is 0.920712098979475; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00546312332153 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.0020202
Louvain completed 21 runs in 13.6775660515 seconds
Similarity is 0.9410935249752233; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00549411773682 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = -0.000296666
After 2 runs, maximum modularity is Q = -0.000296665
After 3 runs, maximum modularity is Q = -0.000296663
After 8 runs, maximum modularity is Q = 1.15279e-09
After 16 runs, maximum modularity is Q = 4.17885e-09
Louvain completed 36 runs in 26.2034928799 seconds
Merging on 4 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 2 & 3 with prob 0.00010761632032575974 and sim 7.880828616357288
Collapsing 0 & 3 with prob 6.679869563810153e-06 and sim 7.540038909326178
Collapsing 0 & 2 with prob 0.00011399908399817788 and sim 7.488005820089768
Trimmed 0 out of 64
Trimmed 0 out of 110
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 2 patterns after merging
Performing seqlet reassignment
Got 2 patterns after reassignment
Total time taken is 213.4s
On metacluster 6
Metacluster size 254
Relevant tasks:  ('task1', 'task2', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 254
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 4.04 s
Starting affinity matrix computations
Normalization computed in 0.16 s
Cosine similarity mat computed in 0.34 s
Normalization computed in 0.18 s
Cosine similarity mat computed in 0.25 s
Finished affinity matrix computations in 0.6 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 30.61 s
Launching nearest neighbors affmat calculation job
Job completed in: 30.9 s
(Round 1) Computed affinity matrix on nearest neighbors in 63.11 s
Filtered down to 252 of 254
(Round 1) Retained 252 rows out of 254 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 252 samples in 0.000s...
[t-SNE] Computed neighbors for 252 samples in 0.003s...
[t-SNE] Computed conditional probabilities for sample 252 / 252
[t-SNE] Mean sigma: 0.192483
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0260498523712 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.8s finished
Louvain completed 200 runs in 1.44574093819 seconds
Wrote graph to binary file in 0.0325269699097 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.689311
Louvain completed 51 runs in 32.2110540867 seconds
Preproc + Louvain took 33.7436199188 s
Got 6 clusters after round 1
Counts:
{0: 69, 1: 67, 2: 54, 3: 32, 4: 27, 5: 3}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 69 seqlets
Trimmed 0 out of 69
Aggregating for cluster 1 with 67 seqlets
Trimmed 1 out of 67
Aggregating for cluster 2 with 54 seqlets
Trimmed 0 out of 54
Aggregating for cluster 3 with 32 seqlets
Trimmed 1 out of 32
Aggregating for cluster 4 with 27 seqlets
Trimmed 2 out of 27
Aggregating for cluster 5 with 3 seqlets
Trimmed 0 out of 3
(Round 2) num seqlets: 248
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 5.17 s
Starting affinity matrix computations
Normalization computed in 0.16 s
Cosine similarity mat computed in 0.28 s
Normalization computed in 0.16 s
Cosine similarity mat computed in 0.29 s
Finished affinity matrix computations in 0.58 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 47.32 s
Launching nearest neighbors affmat calculation job
Job completed in: 47.55 s
(Round 2) Computed affinity matrix on nearest neighbors in 96.83 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 248 samples in 0.000s...
[t-SNE] Computed neighbors for 248 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 248 / 248
[t-SNE] Mean sigma: 0.184717
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0264449119568 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.69013118744 seconds
Wrote graph to binary file in 0.0446619987488 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.562683
After 8 runs, maximum modularity is Q = 0.585579
After 15 runs, maximum modularity is Q = 0.585993
Louvain completed 65 runs in 42.3651800156 seconds
Preproc + Louvain took 44.1525270939 s
Got 6 clusters after round 2
Counts:
{0: 93, 1: 73, 2: 34, 3: 24, 4: 21, 5: 3}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 93 seqlets
Trimmed 0 out of 93
Aggregating for cluster 1 with 73 seqlets
Trimmed 2 out of 73
Aggregating for cluster 2 with 34 seqlets
Trimmed 3 out of 34
Aggregating for cluster 3 with 24 seqlets
Trimmed 0 out of 24
Aggregating for cluster 4 with 21 seqlets
Trimmed 0 out of 21
Aggregating for cluster 5 with 3 seqlets
Trimmed 0 out of 3
Got 6 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00839996337891 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00348221
Louvain completed 21 runs in 13.7755451202 seconds
Similarity is 0.9535226072166711; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00706887245178 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000465672
After 2 runs, maximum modularity is Q = 0.000644395
After 3 runs, maximum modularity is Q = 0.00143113
After 6 runs, maximum modularity is Q = 0.00143114
Louvain completed 26 runs in 17.9897358418 seconds
Similarity is 0.9700944717350479; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00418782234192 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = -0.000425163
After 2 runs, maximum modularity is Q = -4.10527e-09
After 5 runs, maximum modularity is Q = -1.67943e-09
After 8 runs, maximum modularity is Q = 0.0
After 17 runs, maximum modularity is Q = 1.86603e-09
After 37 runs, maximum modularity is Q = 4.29188e-09
Louvain completed 57 runs in 37.9647490978 seconds
Merging on 6 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 1 & 4 with prob 6.856854747757841e-06 and sim 7.828198252185639
Collapsing 0 & 2 with prob 1.1038469833378357e-05 and sim 7.822643187903133
Collapsing 1 & 3 with prob 6.356924568191266e-06 and sim 7.757667645325597
Trimmed 0 out of 92
Trimmed 0 out of 124
Trimmed 0 out of 116
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 0.0008507114612537988 and sim 6.938206200677402
Trimmed 0 out of 240
On merging iteration 3
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 2 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 0.38 s
Cross contin jaccard time taken: 0.33 s
Got 1 patterns after reassignment
Total time taken is 352.42s
On metacluster 5
Metacluster size 294
Relevant tasks:  ('task1', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 294
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 5.09 s
Starting affinity matrix computations
Normalization computed in 0.19 s
Cosine similarity mat computed in 0.31 s
Normalization computed in 0.2 s
Cosine similarity mat computed in 0.31 s
Finished affinity matrix computations in 0.62 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 30.62 s
Launching nearest neighbors affmat calculation job
Job completed in: 30.79 s
(Round 1) Computed affinity matrix on nearest neighbors in 63.26 s
Filtered down to 289 of 294
(Round 1) Retained 289 rows out of 294 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 289 samples in 0.000s...
[t-SNE] Computed neighbors for 289 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 289 / 289
[t-SNE] Mean sigma: 0.200330
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0167219638824 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.0s finished
Louvain completed 200 runs in 1.66896700859 seconds
Wrote graph to binary file in 0.0343549251556 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.663993
Louvain completed 51 runs in 33.5090219975 seconds
Preproc + Louvain took 35.2517991066 s
Got 8 clusters after round 1
Counts:
{0: 70, 1: 67, 2: 67, 3: 35, 4: 26, 5: 13, 6: 7, 7: 4}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 70 seqlets
Trimmed 1 out of 70
Aggregating for cluster 1 with 67 seqlets
Trimmed 1 out of 67
Aggregating for cluster 2 with 67 seqlets
Trimmed 6 out of 67
Aggregating for cluster 3 with 35 seqlets
Trimmed 0 out of 35
Aggregating for cluster 4 with 26 seqlets
Trimmed 0 out of 26
Aggregating for cluster 5 with 13 seqlets
Trimmed 0 out of 13
Aggregating for cluster 6 with 7 seqlets
Trimmed 0 out of 7
Aggregating for cluster 7 with 4 seqlets
Trimmed 0 out of 4
(Round 2) num seqlets: 281
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 5.87 s
Starting affinity matrix computations
Normalization computed in 0.18 s
Cosine similarity mat computed in 0.3 s
Normalization computed in 0.19 s
Cosine similarity mat computed in 0.35 s
Finished affinity matrix computations in 0.66 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 52.5 s
Launching nearest neighbors affmat calculation job
Job completed in: 52.46 s
(Round 2) Computed affinity matrix on nearest neighbors in 106.92 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 281 samples in 0.000s...
[t-SNE] Computed neighbors for 281 samples in 0.003s...
[t-SNE] Computed conditional probabilities for sample 281 / 281
[t-SNE] Mean sigma: 0.193316
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0266940593719 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.0s finished
Louvain completed 200 runs in 1.7250058651 seconds
Wrote graph to binary file in 0.0392851829529 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.635661
After 7 runs, maximum modularity is Q = 0.662534
Louvain completed 57 runs in 36.8716928959 seconds
Preproc + Louvain took 38.6824939251 s
Got 5 clusters after round 2
Counts:
{0: 97, 1: 68, 2: 66, 3: 35, 4: 15}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 97 seqlets
Trimmed 4 out of 97
Aggregating for cluster 1 with 68 seqlets
Trimmed 9 out of 68
Aggregating for cluster 2 with 66 seqlets
Trimmed 4 out of 66
Aggregating for cluster 3 with 35 seqlets
Trimmed 7 out of 35
Aggregating for cluster 4 with 15 seqlets
Trimmed 2 out of 15
Got 5 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00705599784851 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00296083
Louvain completed 21 runs in 13.5156030655 seconds
Similarity is 0.9600868904790876; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00422501564026 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00133685
Louvain completed 21 runs in 13.5047399998 seconds
Similarity is 0.9647860557441017; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00462293624878 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000857895
After 2 runs, maximum modularity is Q = 0.000860914
After 7 runs, maximum modularity is Q = 0.000860918
After 13 runs, maximum modularity is Q = 0.000860921
After 19 runs, maximum modularity is Q = 0.000881843
Louvain completed 39 runs in 27.1653940678 seconds
Similarity is 0.9709954180486533; is_dissimilar is False
Merging on 5 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 1 & 2 with prob 0.00020461297561401746 and sim 6.894046806744265
Collapsing 0 & 3 with prob 4.811564091725475e-05 and sim 6.561924908365482
Collapsing 0 & 1 with prob 7.884654538071326e-05 and sim 6.142105231460366
Collapsing 2 & 3 with prob 2.0412258394271675e-05 and sim 6.137483236579725
Trimmed 0 out of 121
Trimmed 0 out of 121
Trimmed 0 out of 242
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 2 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 1.44 s
Cross contin jaccard time taken: 0.99 s
Got 1 patterns after reassignment
Total time taken is 337.65s
On metacluster 4
Metacluster size 309
Relevant tasks:  ('task3',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 309
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 4.8 s
Starting affinity matrix computations
Normalization computed in 0.2 s
Cosine similarity mat computed in 0.33 s
Normalization computed in 0.2 s
Cosine similarity mat computed in 0.29 s
Finished affinity matrix computations in 0.63 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
6827776
Job completed in: 27.75 s
Launching nearest neighbors affmat calculation job
Job completed in: 28.8 s
(Round 1) Computed affinity matrix on nearest neighbors in 56.82 s
Filtered down to 302 of 309
(Round 1) Retained 302 rows out of 309 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 302 samples in 0.000s...
[t-SNE] Computed neighbors for 302 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 302 / 302
[t-SNE] Mean sigma: 0.212630
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0162868499756 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.0s finished
Louvain completed 200 runs in 1.67234396935 seconds
Wrote graph to binary file in 0.0326619148254 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.735362
After 17 runs, maximum modularity is Q = 0.7419
Louvain completed 67 runs in 44.1381151676 seconds
Preproc + Louvain took 45.8811590672 s
Got 6 clusters after round 1
Counts:
{0: 67, 1: 64, 2: 60, 3: 59, 4: 42, 5: 10}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 67 seqlets
Trimmed 6 out of 67
Aggregating for cluster 1 with 64 seqlets
Trimmed 5 out of 64
Aggregating for cluster 2 with 60 seqlets
Trimmed 4 out of 60
Aggregating for cluster 3 with 59 seqlets
Trimmed 2 out of 59
Aggregating for cluster 4 with 42 seqlets
Trimmed 4 out of 42
Aggregating for cluster 5 with 10 seqlets
Trimmed 0 out of 10
(Round 2) num seqlets: 281
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 5.53 s
Starting affinity matrix computations
Normalization computed in 0.19 s
Cosine similarity mat computed in 0.36 s
Normalization computed in 0.18 s
Cosine similarity mat computed in 0.29 s
Finished affinity matrix computations in 0.66 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 27.18 s
Launching nearest neighbors affmat calculation job
Job completed in: 27.19 s
(Round 2) Computed affinity matrix on nearest neighbors in 54.64 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 281 samples in 0.000s...
[t-SNE] Computed neighbors for 281 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 281 / 281
[t-SNE] Mean sigma: 0.214104
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0163249969482 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.59351205826 seconds
Wrote graph to binary file in 0.0371270179749 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.65262
After 2 runs, maximum modularity is Q = 0.673619
After 10 runs, maximum modularity is Q = 0.676881
Louvain completed 60 runs in 39.1537790298 seconds
Preproc + Louvain took 40.8211421967 s
Got 5 clusters after round 2
Counts:
{0: 100, 1: 58, 2: 58, 3: 47, 4: 18}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 100 seqlets
Trimmed 9 out of 100
Aggregating for cluster 1 with 58 seqlets
Trimmed 4 out of 58
Aggregating for cluster 2 with 58 seqlets
Trimmed 1 out of 58
Aggregating for cluster 3 with 47 seqlets
Trimmed 16 out of 47
Aggregating for cluster 4 with 18 seqlets
Trimmed 0 out of 18
Got 5 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00690984725952 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00177041
After 2 runs, maximum modularity is Q = 0.00227333
Louvain completed 22 runs in 14.5216839314 seconds
Similarity is 0.9511377043238374; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00649809837341 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00437992
Louvain completed 21 runs in 13.5369560719 seconds
Similarity is 0.8988479172576872; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00830984115601 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00488549
After 3 runs, maximum modularity is Q = 0.00505794
Louvain completed 23 runs in 15.6276381016 seconds
Similarity is 0.8780450654820221; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00405383110046 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000779962
After 7 runs, maximum modularity is Q = 0.00077997
Louvain completed 27 runs in 20.4763588905 seconds
Similarity is 0.920097566067061; is_dissimilar is False
Merging on 5 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 3 with prob 4.396554193205808e-05 and sim 0.8941818468522067
Trimmed 0 out of 122
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 4 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 0.29 s
Cross contin jaccard time taken: 0.26 s
Discarded 7 seqlets
Got 3 patterns after reassignment
Total time taken is 285.08s
On metacluster 3
Metacluster size 315
Relevant tasks:  ('task0', 'task1', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 315
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 5.21 s
Starting affinity matrix computations
Normalization computed in 0.21 s
Cosine similarity mat computed in 0.38 s
Normalization computed in 0.2 s
Cosine similarity mat computed in 0.33 s
Finished affinity matrix computations in 0.72 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 49.29 s
Launching nearest neighbors affmat calculation job
Job completed in: 50.0 s
(Round 1) Computed affinity matrix on nearest neighbors in 101.61 s
Filtered down to 310 of 315
(Round 1) Retained 310 rows out of 315 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 310 samples in 0.000s...
[t-SNE] Computed neighbors for 310 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 310 / 310
[t-SNE] Mean sigma: 0.184302
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0195591449738 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.531208992 seconds
Wrote graph to binary file in 0.0334329605103 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.694869
Louvain completed 51 runs in 33.5882840157 seconds
Preproc + Louvain took 35.1904881001 s
Got 9 clusters after round 1
Counts:
{0: 69, 1: 56, 2: 54, 3: 36, 4: 29, 5: 21, 6: 19, 7: 17, 8: 9}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 69 seqlets
Trimmed 2 out of 69
Aggregating for cluster 1 with 56 seqlets
Trimmed 2 out of 56
Aggregating for cluster 2 with 54 seqlets
Trimmed 0 out of 54
Aggregating for cluster 3 with 36 seqlets
Trimmed 0 out of 36
Aggregating for cluster 4 with 29 seqlets
Trimmed 0 out of 29
Aggregating for cluster 5 with 21 seqlets
Trimmed 1 out of 21
Aggregating for cluster 6 with 19 seqlets
Trimmed 0 out of 19
Aggregating for cluster 7 with 17 seqlets
Trimmed 3 out of 17
Aggregating for cluster 8 with 9 seqlets
Trimmed 0 out of 9
(Round 2) num seqlets: 302
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 6.01 s
Starting affinity matrix computations
Normalization computed in 0.2 s
Cosine similarity mat computed in 0.4 s
Normalization computed in 0.19 s
Cosine similarity mat computed in 0.35 s
Finished affinity matrix computations in 0.76 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.01 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 72.05 s
Launching nearest neighbors affmat calculation job
Job completed in: 72.53 s
(Round 2) Computed affinity matrix on nearest neighbors in 147.11 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 302 samples in 0.000s...
[t-SNE] Computed neighbors for 302 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 302 / 302
[t-SNE] Mean sigma: 0.177176
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0224089622498 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    0.9s finished
Louvain completed 200 runs in 1.54344511032 seconds
Wrote graph to binary file in 0.0403580665588 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.584053
After 2 runs, maximum modularity is Q = 0.589533
After 3 runs, maximum modularity is Q = 0.590405
After 21 runs, maximum modularity is Q = 0.596246
After 62 runs, maximum modularity is Q = 0.598
After 77 runs, maximum modularity is Q = 0.602552
Louvain completed 127 runs in 85.6242620945 seconds
Preproc + Louvain took 87.2522690296 s
Got 7 clusters after round 2
Counts:
{0: 73, 1: 67, 2: 50, 3: 50, 4: 35, 5: 19, 6: 8}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 73 seqlets
Trimmed 12 out of 73
Aggregating for cluster 1 with 67 seqlets
Trimmed 15 out of 67
Aggregating for cluster 2 with 50 seqlets
Trimmed 0 out of 50
Aggregating for cluster 3 with 50 seqlets
Trimmed 0 out of 50
Aggregating for cluster 4 with 35 seqlets
Trimmed 1 out of 35
Aggregating for cluster 5 with 19 seqlets
Trimmed 3 out of 19
Aggregating for cluster 6 with 8 seqlets
Trimmed 0 out of 8
Got 7 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.00355315208435 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00245037
Louvain completed 21 runs in 13.6031029224 seconds
Similarity is 0.9587304836636811; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00246596336365 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.000828353
After 2 runs, maximum modularity is Q = 0.00106208
Louvain completed 22 runs in 15.2653000355 seconds
Similarity is 0.9517254744988417; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00372290611267 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00132116
After 4 runs, maximum modularity is Q = 0.00134435
After 12 runs, maximum modularity is Q = 0.00134436
Louvain completed 32 runs in 22.1601550579 seconds
Similarity is 0.9596742354834056; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00417685508728 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00147205
Louvain completed 21 runs in 16.2507641315 seconds
Similarity is 0.977687662835877; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00220203399658 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.0021759
Louvain completed 21 runs in 13.3893098831 seconds
Similarity is 0.9375645125071012; is_dissimilar is False
Merging on 7 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 2 & 3 with prob 5.615343481111024e-06 and sim 7.907154464237367
Collapsing 1 & 2 with prob 3.7205543929512398e-06 and sim 7.873580537799153
Collapsing 1 & 3 with prob 6.83022291071762e-06 and sim 7.869458378650359
Collapsing 0 & 1 with prob 2.245454010225111e-05 and sim 7.866742826354567
Collapsing 0 & 2 with prob 1.0515659047843116e-06 and sim 7.81820057898268
Collapsing 0 & 3 with prob 6.556597234731149e-05 and sim 7.770967448982802
Trimmed 0 out of 100
Trimmed 0 out of 152
Trimmed 0 out of 213
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 1.6452142667742595e-06 and sim 7.74705861542103
Trimmed 1 out of 247
On merging iteration 3
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 3 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 2.86 s
Cross contin jaccard time taken: 3.07 s
Got 1 patterns after reassignment
Total time taken is 512.42s
On metacluster 2
Metacluster size 650
Relevant tasks:  ('task0', 'task1', 'task2', 'task3', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 650
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 10.5 s
Starting affinity matrix computations
Normalization computed in 0.42 s
Cosine similarity mat computed in 0.68 s
Normalization computed in 0.42 s
Cosine similarity mat computed in 0.7 s
Finished affinity matrix computations in 1.4 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.03 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
2
Job completed in: 228.84 s
Launching nearest neighbors affmat calculation job
Job completed in: 228.74 s
(Round 1) Computed affinity matrix on nearest neighbors in 466.85 s
Filtered down to 615 of 650
(Round 1) Retained 615 rows out of 650 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 615 samples in 0.000s...
[t-SNE] Computed neighbors for 615 samples in 0.006s...
[t-SNE] Computed conditional probabilities for sample 615 / 615
[t-SNE] Mean sigma: 0.176878
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0256519317627 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.3s finished
Louvain completed 200 runs in 2.16425299644 seconds
Wrote graph to binary file in 0.0805490016937 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.683189
After 3 runs, maximum modularity is Q = 0.725505
After 8 runs, maximum modularity is Q = 0.725702
After 35 runs, maximum modularity is Q = 0.725756
After 59 runs, maximum modularity is Q = 0.72578
Louvain completed 109 runs in 73.4928059578 seconds
Preproc + Louvain took 75.8039410114 s
Got 8 clusters after round 1
Counts:
{0: 166, 1: 126, 2: 105, 3: 93, 4: 71, 5: 36, 6: 15, 7: 3}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 166 seqlets
Trimmed 4 out of 166
Aggregating for cluster 1 with 126 seqlets
Trimmed 1 out of 126
Aggregating for cluster 2 with 105 seqlets
Trimmed 3 out of 105
Aggregating for cluster 3 with 93 seqlets
Trimmed 4 out of 93
Aggregating for cluster 4 with 71 seqlets
Trimmed 2 out of 71
Aggregating for cluster 5 with 36 seqlets
Trimmed 3 out of 36
Aggregating for cluster 6 with 15 seqlets
Trimmed 0 out of 15
Aggregating for cluster 7 with 3 seqlets
Trimmed 0 out of 3
(Round 2) num seqlets: 598
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 11.95 s
Starting affinity matrix computations
Normalization computed in 0.4 s
Cosine similarity mat computed in 0.69 s
Normalization computed in 0.38 s
Cosine similarity mat computed in 0.61 s
Finished affinity matrix computations in 1.32 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.02 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 324.31 s
Launching nearest neighbors affmat calculation job

Job completed in: 323.67 s
(Round 2) Computed affinity matrix on nearest neighbors in 658.45 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 598 samples in 0.000s...
[t-SNE] Computed neighbors for 598 samples in 0.005s...
[t-SNE] Computed conditional probabilities for sample 598 / 598
[t-SNE] Mean sigma: 0.169593
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0283079147339 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.1s finished
Louvain completed 200 runs in 1.96038818359 seconds
Wrote graph to binary file in 0.0943920612335 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.625954
After 3 runs, maximum modularity is Q = 0.626262
Louvain completed 53 runs in 34.6525628567 seconds
Preproc + Louvain took 36.7686569691 s
Got 9 clusters after round 2
Counts:
{0: 159, 1: 117, 2: 100, 3: 76, 4: 58, 5: 50, 6: 24, 7: 10, 8: 4}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 159 seqlets
Trimmed 0 out of 159
Aggregating for cluster 1 with 117 seqlets
Trimmed 12 out of 117
Aggregating for cluster 2 with 100 seqlets
Trimmed 4 out of 100
Aggregating for cluster 3 with 76 seqlets
Trimmed 0 out of 76
Aggregating for cluster 4 with 58 seqlets
Trimmed 0 out of 58
Aggregating for cluster 5 with 50 seqlets
Trimmed 3 out of 50
Aggregating for cluster 6 with 24 seqlets
Trimmed 0 out of 24
Aggregating for cluster 7 with 10 seqlets
Trimmed 1 out of 10
Aggregating for cluster 8 with 4 seqlets
Trimmed 0 out of 4
Got 9 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.0175218582153 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00285786
Louvain completed 21 runs in 13.6746649742 seconds
Similarity is 0.9812011156327287; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00796794891357 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00203121
After 5 runs, maximum modularity is Q = 0.00203345
After 11 runs, maximum modularity is Q = 0.00207135
After 18 runs, maximum modularity is Q = 0.00207136
Louvain completed 38 runs in 26.2874691486 seconds
Similarity is 0.9796807687860014; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00877904891968 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00455446
After 6 runs, maximum modularity is Q = 0.00455447
Louvain completed 26 runs in 17.1945528984 seconds
Similarity is 0.9728910062198299; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00524497032166 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00259297
After 2 runs, maximum modularity is Q = 0.00259298
Louvain completed 22 runs in 15.6122608185 seconds
Similarity is 0.9691183065093901; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00356101989746 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.0158228
Louvain completed 21 runs in 13.5784311295 seconds
Similarity is 0.7761071982977088; is_dissimilar is True
Inspecting for spurious merging
Wrote graph to binary file in 0.00272393226624 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00357492
Louvain completed 21 runs in 13.8870389462 seconds
Similarity is 0.8830991919382947; is_dissimilar is False
Got 2 subclusters
Inspecting for spurious merging
Wrote graph to binary file in 0.00238800048828 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00213506
Louvain completed 21 runs in 15.2004981041 seconds
Similarity is 0.9739727244443595; is_dissimilar is False
Merging on 10 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 6.737626449856289e-05 and sim 9.932585729179149
Collapsing 0 & 2 with prob 7.502514041140059e-05 and sim 9.871121166542327
Collapsing 1 & 2 with prob 7.185160860562773e-05 and sim 9.79630873870767
Collapsing 0 & 6 with prob 9.570728314571758e-06 and sim 9.729197123858912
Collapsing 2 & 3 with prob 3.4336467175360672e-06 and sim 9.717502160140501
Trimmed 1 out of 264
Trimmed 0 out of 359
Trimmed 1 out of 406
Trimmed 0 out of 481
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 6 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 0.28 s
Cross contin jaccard time taken: 0.28 s
Got 2 patterns after reassignment
Total time taken is 1476.82s
On metacluster 1
Metacluster size 672
Relevant tasks:  ('task0', 'task1', 'task2', 'task4', 'task5', 'task6', 'task7', 'task8', 'task9')
Relevant signs:  (1, 1, 1, 1, 1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 672
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 10.35 s
Starting affinity matrix computations
Normalization computed in 0.41 s
Cosine similarity mat computed in 0.64 s
Normalization computed in 0.42 s
Cosine similarity mat computed in 0.64 s
Finished affinity matrix computations in 1.3 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.02 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 177.05 s
Launching nearest neighbors affmat calculation job
Job completed in: 176.97 s
(Round 1) Computed affinity matrix on nearest neighbors in 362.52 s
Filtered down to 618 of 672
(Round 1) Retained 618 rows out of 672 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 618 samples in 0.000s...
[t-SNE] Computed neighbors for 618 samples in 0.006s...
[t-SNE] Computed conditional probabilities for sample 618 / 618
[t-SNE] Mean sigma: 0.173642
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0275611877441 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.4s finished
Louvain completed 200 runs in 2.28906798363 seconds
Wrote graph to binary file in 0.113184928894 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.629915
After 28 runs, maximum modularity is Q = 0.634571
Louvain completed 78 runs in 54.4433870316 seconds
Preproc + Louvain took 56.9904510975 s
Got 8 clusters after round 1
Counts:
{0: 180, 1: 107, 2: 103, 3: 81, 4: 48, 5: 38, 6: 33, 7: 28}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 180 seqlets
Trimmed 7 out of 180
Aggregating for cluster 1 with 107 seqlets
Trimmed 4 out of 107
Aggregating for cluster 2 with 103 seqlets
Trimmed 7 out of 103
Aggregating for cluster 3 with 81 seqlets
Trimmed 12 out of 81
Aggregating for cluster 4 with 48 seqlets
Trimmed 0 out of 48
Aggregating for cluster 5 with 38 seqlets
Trimmed 1 out of 38
Aggregating for cluster 6 with 33 seqlets
Trimmed 0 out of 33
Aggregating for cluster 7 with 28 seqlets
Trimmed 1 out of 28
(Round 2) num seqlets: 586
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 11.4 s
Starting affinity matrix computations
Normalization computed in 0.37 s
Cosine similarity mat computed in 0.63 s
Normalization computed in 0.37 s
Cosine similarity mat computed in 0.66 s
Finished affinity matrix computations in 1.32 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.02 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 238.46 s
Launching nearest neighbors affmat calculation job
Job completed in: 238.07 s
(Round 2) Computed affinity matrix on nearest neighbors in 485.71 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 586 samples in 0.000s...
[t-SNE] Computed neighbors for 586 samples in 0.005s...
[t-SNE] Computed conditional probabilities for sample 586 / 586
[t-SNE] Mean sigma: 0.167903
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0318241119385 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.3s finished
Louvain completed 200 runs in 2.20165610313 seconds
Wrote graph to binary file in 0.109022855759 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.620864
After 14 runs, maximum modularity is Q = 0.633252
Louvain completed 64 runs in 43.4975600243 seconds
Preproc + Louvain took 45.8921759129 s
Got 8 clusters after round 2
Counts:
{0: 180, 1: 146, 2: 112, 3: 38, 4: 34, 5: 29, 6: 25, 7: 22}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 180 seqlets
Trimmed 24 out of 180
Aggregating for cluster 1 with 146 seqlets
Trimmed 1 out of 146
Aggregating for cluster 2 with 112 seqlets
Trimmed 24 out of 112
Aggregating for cluster 3 with 38 seqlets
Trimmed 0 out of 38
Aggregating for cluster 4 with 34 seqlets
Trimmed 1 out of 34
Aggregating for cluster 5 with 29 seqlets
Trimmed 4 out of 29
Aggregating for cluster 6 with 25 seqlets
Trimmed 5 out of 25
Aggregating for cluster 7 with 22 seqlets
Trimmed 1 out of 22
Got 8 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.0166311264038 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.0023642
After 2 runs, maximum modularity is Q = 0.00236781
After 3 runs, maximum modularity is Q = 0.00237781
After 5 runs, maximum modularity is Q = 0.00237795
Louvain completed 25 runs in 18.405987978 seconds
Similarity is 0.9827222809009171; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0190908908844 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.001483
After 2 runs, maximum modularity is Q = 0.0018134
After 3 runs, maximum modularity is Q = 0.00181968
Louvain completed 23 runs in 17.0145661831 seconds
Similarity is 0.9879907351822013; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00814604759216 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00185157
Louvain completed 21 runs in 13.8017270565 seconds
Similarity is 0.9719883941409616; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00173282623291 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = -0.000166019
After 2 runs, maximum modularity is Q = 0.000806603
After 4 runs, maximum modularity is Q = 0.000990578
After 7 runs, maximum modularity is Q = 0.00099058
After 10 runs, maximum modularity is Q = 0.000990581
After 11 runs, maximum modularity is Q = 0.000990583
Louvain completed 31 runs in 24.1702020168 seconds
Similarity is 0.961771421295429; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00113081932068 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00117415
After 4 runs, maximum modularity is Q = 0.00117416
Louvain completed 24 runs in 17.6573021412 seconds
Similarity is 0.9361352574425832; is_dissimilar is False
Merging on 8 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 0.0002081605856988635 and sim 8.9154119454354
Collapsing 0 & 2 with prob 3.814487290452373e-06 and sim 8.870991721719168
Collapsing 1 & 2 with prob 3.5874714934583806e-05 and sim 8.849048619441549
Collapsing 1 & 3 with prob 8.808486222616617e-06 and sim 8.841944339911382
Collapsing 2 & 3 with prob 5.073396591238286e-06 and sim 8.807819977610972
Collapsing 0 & 6 with prob 3.618017399794438e-06 and sim 8.43544764295471
Collapsing 0 & 4 with prob 1.7645983494642438e-06 and sim 8.151803324960262
Aborting collapse as 1 & 4 have prob 3.3370647757181596e-08 and sim 7.946805300650926
Aborting collapse as 2 & 4 have prob 4.015329756599489e-09 and sim 8.073261471257165
Aborting collapse as 3 & 4 have prob 2.165316204519042e-10 and sim 7.78741951742407
Aborting collapse as 4 & 6 have prob 4.3518902810125195e-09 and sim 7.352676869657188
Trimmed 0 out of 301
Trimmed 0 out of 389
Trimmed 0 out of 427
Trimmed 20 out of 447
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 4 patterns after merging
Performing seqlet reassignment
Cross contin jaccard time taken: 0.28 s
Cross contin jaccard time taken: 0.3 s
Discarded 1 seqlets
Got 2 patterns after reassignment
Total time taken is 1142.11s
On metacluster 0
Metacluster size 860
Relevant tasks:  ('task2',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 860
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 13.7 s
Starting affinity matrix computations
Normalization computed in 0.58 s
Cosine similarity mat computed in 0.93 s
Normalization computed in 0.57 s
Cosine similarity mat computed in 0.84 s
Finished affinity matrix computations in 1.81 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.05 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 15.34 s
Launching nearest neighbors affmat calculation job
Job completed in: 15.37 s
(Round 1) Computed affinity matrix on nearest neighbors in 32.09 s
Filtered down to 859 of 860
(Round 1) Retained 859 rows out of 860 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 859 samples in 0.000s...
[t-SNE] Computed neighbors for 859 samples in 0.009s...
[t-SNE] Computed conditional probabilities for sample 859 / 859
[t-SNE] Mean sigma: 0.181621
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0420999526978 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.5s finished
Louvain completed 200 runs in 2.81109189987 seconds
Wrote graph to binary file in 0.244432926178 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.714482
Louvain completed 51 runs in 36.1977801323 seconds
Preproc + Louvain took 39.3786561489 s
Got 8 clusters after round 1
Counts:
{0: 189, 1: 177, 2: 167, 3: 111, 4: 82, 5: 78, 6: 41, 7: 14}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 189 seqlets
Trimmed 14 out of 189
Aggregating for cluster 1 with 177 seqlets
Trimmed 11 out of 177
Aggregating for cluster 2 with 167 seqlets
Trimmed 9 out of 167
Aggregating for cluster 3 with 111 seqlets
Trimmed 2 out of 111
Aggregating for cluster 4 with 82 seqlets
Trimmed 5 out of 82
Aggregating for cluster 5 with 78 seqlets
Trimmed 2 out of 78
Aggregating for cluster 6 with 41 seqlets
Trimmed 4 out of 41
Aggregating for cluster 7 with 14 seqlets
Trimmed 0 out of 14
(Round 2) num seqlets: 812
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 15.96 s
Starting affinity matrix computations
Normalization computed in 0.55 s
Cosine similarity mat computed in 0.9 s
Normalization computed in 0.51 s
Cosine similarity mat computed in 0.83 s
Finished affinity matrix computations in 1.77 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.04 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 21.42 s
Launching nearest neighbors affmat calculation job
Job completed in: 21.35 s
(Round 2) Computed affinity matrix on nearest neighbors in 44.31 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 812 samples in 0.000s...
[t-SNE] Computed neighbors for 812 samples in 0.009s...
[t-SNE] Computed conditional probabilities for sample 812 / 812
[t-SNE] Mean sigma: 0.178173
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0782718658447 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    1.3s finished
Louvain completed 200 runs in 2.29435992241 seconds
Wrote graph to binary file in 0.202944993973 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.635307
After 15 runs, maximum modularity is Q = 0.64549
Louvain completed 65 runs in 47.6797809601 seconds
Preproc + Louvain took 50.3164241314 s
Got 5 clusters after round 2
Counts:
{0: 233, 1: 208, 2: 139, 3: 126, 4: 106}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 233 seqlets
Trimmed 30 out of 233
Aggregating for cluster 1 with 208 seqlets
Trimmed 31 out of 208
Aggregating for cluster 2 with 139 seqlets
Trimmed 19 out of 139
Aggregating for cluster 3 with 126 seqlets
Trimmed 24 out of 126
Aggregating for cluster 4 with 106 seqlets
Trimmed 12 out of 106
Got 5 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.0285301208496 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00208594
After 4 runs, maximum modularity is Q = 0.00209577
Louvain completed 24 runs in 16.9743890762 seconds
Similarity is 0.963823804925426; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0264868736267 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00209511
After 2 runs, maximum modularity is Q = 0.00249761
After 6 runs, maximum modularity is Q = 0.00249762
Louvain completed 26 runs in 18.3763730526 seconds
Similarity is 0.96491891460286; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0156939029694 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00719543
Louvain completed 21 runs in 16.236410141 seconds
Similarity is 0.9088368490102365; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0124139785767 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00301925
Louvain completed 21 runs in 15.6135540009 seconds
Similarity is 0.9539927712953182; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0115180015564 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00315812
After 3 runs, maximum modularity is Q = 0.00327622
After 5 runs, maximum modularity is Q = 0.00327623
Louvain completed 25 runs in 18.0270330906 seconds
Similarity is 0.9498769145985828; is_dissimilar is False
Merging on 5 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 0.00015213927841104975 and sim 0.969603518572248
Collapsing 1 & 3 with prob 1.8694670329222723e-05 and sim 0.9642931069069277
Collapsing 0 & 3 with prob 0.0021128870026768994 and sim 0.9630638383176748
Collapsing 1 & 2 with prob 0.0026647999021424612 and sim 0.9538115257176444
Collapsing 2 & 4 with prob 2.222902379125077e-06 and sim 0.9445342097157654
Collapsing 0 & 2 with prob 1.4416959029379892e-05 and sim 0.9331139206769778
Collapsing 2 & 3 with prob 1.0343644708217965e-05 and sim 0.930916848246371
Collapsing 0 & 4 with prob 0.00014535487026897054 and sim 0.9139926281795293
Collapsing 3 & 4 with prob 3.6356938158550536e-05 and sim 0.8843208792319556
Trimmed 0 out of 380
Trimmed 0 out of 482
Trimmed 0 out of 602
Trimmed 0 out of 696
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 1 patterns after merging
Performing seqlet reassignment
Got 1 patterns after reassignment
Total time taken is 312.98s
2018-09-20 16:19:19 DEBUG **************** workflow done *********************
2018-09-20 16:19:20 DEBUG **************** result saved *********************

