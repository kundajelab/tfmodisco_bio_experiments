2018-08-23 21:05:01 INFO  /home/ktian/kundajelab/tfnet/scripts/run_tfmodisco.py scores/hyp_scores_task_ subset_nobg.fa subset_nobg.tsv 9
2018-08-23 21:05:01 DEBUG $HOME=/home/ktian
2018-08-23 21:05:01 DEBUG matplotlib data path /home/ktian/anaconda3/envs/modisco_dev/lib/python2.7/site-packages/matplotlib/mpl-data
2018-08-23 21:05:01 DEBUG loaded rc file /home/ktian/anaconda3/envs/modisco_dev/lib/python2.7/site-packages/matplotlib/mpl-data/matplotlibrc
2018-08-23 21:05:01 DEBUG matplotlib version 2.2.2
2018-08-23 21:05:01 DEBUG interactive is False
2018-08-23 21:05:01 DEBUG platform is linux2
2018-08-23 21:05:01 DEBUG loaded modules: ['numpy.testing.nose_tools.nosetester', 'heapq', 'numpy.core.info', 'distutils', 'functools', 'random', 'unittest.types', 'datetime', 'sysconfig', 'json.encoder', 'select', 'gc', 'numpy.lib.numpy', 'distutils.sysconfig', 'ctypes._endian', 'encodings.encodings', 'unittest.pprint', 'matplotlib.colors', 'numpy.core.numerictypes', 'numpy._distributor_init', 'numpy.random.mtrand', 'logging.weakref', 'numpy.matrixlib.defmatrix', 'numpy.random.info', 'tempfile', 'pprint', 'numpy.linalg', 'mkl_fft', 'imp', 'numpy.testing', 'collections', 'logging.thread', 'unittest.sys', 'numpy.core.umath', 'unittest.main', 'distutils.types', 'numpy.lib._version', 'zipimport', 'string', 'json.struct', 'numpy.linalg.info', 'numpy.polynomial._polybase', 'unittest.functools', 'numpy.lib.arraysetops', 'matplotlib.compat', 'encodings.utf_8', 'unittest.util', 'numpy.version', 'distutils.re', 'ctypes.os', 'numpy.core.machar', 'numpy.lib.type_check', 'httplib', 'unittest.StringIO', 'bisect', 'numpy.core._internal', 'signal', 'numpy.random.operator', 'numpy.lib._datasource', 'unittest.re', 'threading', 'token', 'numpy.fft.fftpack_lite', 'json.scanner', 'matplotlib.cbook', '_cython_0_27_3', 'textwrap', 'numpy.core.multiarray', 'cycler', 'numpy.lib', 'numpy.linalg._umath_linalg', 'decimal', 'json.json', 'dis', 'distutils.version', 'cStringIO', 'google', 'logging.threading', 'unittest.time', 'locale', 'numpy.add_newdocs', 'logging.os', 'unittest.difflib', 'numpy.core.getlimits', 'base64', 'atexit', 'pyparsing', 'matplotlib.compat.subprocess', 'encodings', 'matplotlib.cbook.warnings', 'matplotlib._color_data', 'matplotlib.cbook.deprecation', 'logging.traceback', 'matplotlib.cbook.textwrap', 'abc', 'numpy.matrixlib', 'numpy.ma.extras', 'numpy.testing.decorators', 'numpy._globals', 'rfc822', 'numpy.lib.npyio', 'backports', 'matplotlib.sys', 'numpy.random.threading', 're', 'numpy.lib.mixins', '_posixsubprocess32', 'numpy.polynomial.legendre', 'mkl_fft._pydfti', 'numpy.core.shape_base', 'math', 'numpy.fft.helper', 'fcntl', 'unittest.case', 'matplotlib.fontconfig_pattern', 'mpl_toolkits', 'dateutil', 'ast', 'UserDict', 'unittest.suite', 'inspect', 'distutils.os', 'matplotlib', 'fnmatch', '_hashlib', 'ctypes', '_ctypes', 'ctypes.struct', 'codecs', 'backports.functools_lru_cache', 'logging.sys', '_json', 'numpy.os', 'unittest.loader', 'struct', '_functools', '_locale', 'logging', 'socket', 'thread', 'StringIO', 'numpy.core.memmap', 'pickle', 'traceback', 'cython_runtime', 'numpy.lib.info', 'weakref', 'itertools', 'numpy.ctypes', 'opcode', 'numpy.linalg.lapack_lite', 'numpy.ma', 'distutils.sys', 'os', 'marshal', 'mimetools', '__future__', 'six.moves', '_collections', 'urllib', '_sre', 'unittest', 'numpy.random', '__builtin__', 'numpy._mklinit', 'numpy.lib.twodim_base', 'numpy.polynomial', 'unittest.runner', 'operator', 'array', 'numpy.core.arrayprint', 'distutils.string', 'numpy.compat.py3k', 'ctypes._ctypes', '_heapq', 'ctypes.sys', 'six.moves.urllib', 'unittest.collections', 'posixpath', 'numpy.lib.financial', 'numpy.fft.fftpack', 'errno', 'mkl_fft._numpy_fft', '_socket', 'binascii', 'json', 'sre_constants', 'matplotlib.cbook.functools', 'logging.codecs', 'numpy.core._methods', 'os.path', 'numpy.core.function_base', 'tokenize', 'numpy.lib.stride_tricks', 'matplotlib.json', 'numpy', '_warnings', 'numpy.polynomial.chebyshev', 'numpy.testing.nose_tools.utils', 'json.re', 'cPickle', 'encodings.__builtin__', 'numpy.polynomial.hermite_e', '_codecs', 'subprocess32', 'unittest.fnmatch', 'numpy.polynomial.polynomial', 'numpy.__config__', 'encodings.ascii', 'pwd', 'mkl_fft.numpy', 'numpy.ma.core', 'numpy.testing.utils', 'logging.atexit', 'matplotlib.cbook._backports', 'numpy.lib.ufunclike', 'copy', '_sysconfigdata', '_struct', 'numpy.core.fromnumeric', 'hashlib', 'numpy.ctypeslib', 'matplotlib._version', '_ast', 'keyword', 'numpy.lib.scimath', 'numpy.fft', 'zlib', 'numpy.lib.nanfunctions', 'numpy.random.numpy', 'unittest.weakref', 'logging.time', 'numpy.core.multiarray_tests', '_bisect', 'numpy.polynomial.hermite', 'posix', 'encodings.aliases', 'numpy.lib.function_base', 'exceptions', 'sre_parse', 'json._json', 'logging.warnings', 'numpy.random.warnings', 'distutils.distutils', 'unittest.signal', 'copy_reg', 'sre_compile', 'json.sys', 'logging.cStringIO', '_random', 'site', 'numpy.lib.polynomial', 'numpy.compat', 'numpy._import_tools', 'logging.collections', 'backports_abc', 'contextlib', 'numbers', 'io', '__main__', 'numpy.fft.info', 'numpy.core.records', 'shutil', 'numpy.sys', 'numpy.polynomial.polyutils', 'urlparse', 'dateutil._version', 'unittest.result', 'strop', 'grp', 'linecache', 'numpy.core.numeric', 'six', 'encodings.codecs', 'six.moves.urllib.request', '_abcoll', 'matplotlib.testing', 'numpy.core', 'matplotlib.rcsetup', 'genericpath', 'stat', '_ssl', 'numpy.lib._iotools', 'numpy.lib.index_tricks', 'warnings', 'numpy.lib.utils', 'numpy.core.defchararray', 'glob', 'numpy.lib.shape_base', 'urllib2', 'unittest.signals', 'sys', 'unittest.traceback', 'numpy.polynomial.laguerre', 'numpy.compat._inspect', 'numpy.core.einsumfunc', 'ctypes.ctypes', 'numpy.lib.format', 'numpy.lib.arrayterator', 'numpy.testing.nosetester', 'types', 'bz2', 'future_builtins', 'ssl', 'numpy.testing.nose_tools', 'numpy.lib.arraypad', '_weakref', 'numpy.testing.nose_tools.decorators', 'difflib', 'distutils.errors', '_io', '_weakrefset', 'json.decoder', 'unittest.warnings', 'time', 'gzip', 'numpy.linalg.linalg', 'unittest.os']
Using cuDNN version 7001 on context None
Mapped name None to device cuda0: GeForce GTX TITAN X (0000:08:00.0)
2018-08-23 21:05:07 DEBUG Theano version:1.0.2
2018-08-23 21:05:07 DEBUG 2.7.15 |Anaconda, Inc.| (default, May  1 2018, 23:32:55) 
[GCC 7.2.0]
2018-08-23 21:05:07 DEBUG method file prefix is scores/hyp_scores_task_, input seq file is subset_nobg.fa, input tsv is subset_nobg.tsv, start_task is 0 end_task is 9
2018-08-23 21:05:08 DEBUG lenth of sequences = 64404
2018-08-23 21:05:10 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:12 DEBUG shape of hyp_score (400, 4)
2018-08-23 21:05:12 DEBUG shape of score (400, 4)
2018-08-23 21:05:15 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:20 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:25 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:30 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:34 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:38 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:42 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
2018-08-23 21:05:46 DEBUG merged overlaps based on in_tsv subset_nobg.tsv, 64404 seqs merged into 8295 seqs, max len 1932
On task task0
Computing windowed sums
Computing threshold
2018-08-23 21:06:09 DEBUG CACHEDIR=/home/ktian/.cache/matplotlib
2018-08-23 21:06:09 DEBUG Using fontManager instance from /home/ktian/.cache/matplotlib/fontList.json
2018-08-23 21:06:10 DEBUG backend agg version v2.2
2018-08-23 21:06:10 DEBUG findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=10.0 to DejaVu Sans (u'/home/ktian/anaconda3/envs/tfenv/lib/python2.7/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000
peak(mu)= 0.6594507416521795
Manually adjusting thresholds to get desired num seqlets
Mu: 6.594507e-01 +/- 6.963522e-06
Lablace_b: 0.5056742373305261 and 1.1646842650911238
Thresholds: -7.605257941075113 and 8.924159424379472
#fdrs pass: 0 and 0
CDFs: 0.99999992021566 and 0.9991716656707381
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_0.png
Got 72 coords
On task task1
Computing windowed sums
Computing threshold
peak(mu)= 0.47647109278623
Manually adjusting thresholds to get desired num seqlets
Mu: 4.764711e-01 +/- 5.843699e-06
Lablace_b: 0.41109077726546656 and 0.7541706422220883
Thresholds: -6.233976113839896 and 7.186918299412357
#fdrs pass: 0 and 0
CDFs: 0.9999999185695695 and 0.9998633084521354
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_1.png
Got 72 coords
On task task2
Computing windowed sums
Computing threshold
peak(mu)= 0.4656423783521399
Manually adjusting thresholds to get desired num seqlets
Mu: 4.656424e-01 +/- 4.945484e-06
Lablace_b: 0.35674135391688966 and 0.6703969949136297
Thresholds: -5.234703083974726 and 6.165987840679006
#fdrs pass: 0 and 0
CDFs: 0.9999998850686626 and 0.9997971289611249
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_2.png
Got 81 coords
On task task3
Computing windowed sums
Computing threshold
peak(mu)= 0.16002144125200646
Manually adjusting thresholds to get desired num seqlets
Mu: 1.600214e-01 +/- 1.154519e-05
Lablace_b: 0.269951720785771 and 1.2681193311882708
Thresholds: -15.025314927690388 and 15.3453578101944
#fdrs pass: 0 and 0
CDFs: 1.0 and 0.9999936982954036
Est. FDRs: 1.0 and 0.5303941632793258
saving plot to figures/laplace_3.png
Got 82 coords
On task task4
Computing windowed sums
Computing threshold
peak(mu)= 0.5878415940717414
Manually adjusting thresholds to get desired num seqlets
Mu: 5.878416e-01 +/- 4.405317e-06
Lablace_b: 0.33957201650742525 and 0.5330983476175686
Thresholds: -5.0532032094313895 and 6.228886397574872
#fdrs pass: 0 and 0
CDFs: 0.9999999389894655 and 0.9999746218312112
Est. FDRs: 1.0 and 1.0
saving plot to figures/laplace_4.png
Got 87 coords
On task task5
Computing windowed sums
Computing threshold
peak(mu)= 0.3198500852682337
Mu: 3.198501e-01 +/- 1.507994e-05
Lablace_b: 0.3571305146752764 and 1.1672340120683404
Thresholds: -3.5863113856493425 and 10.656880066264424
#fdrs pass: 0 and 49294
CDFs: 0.9999822234451325 and 0.9998574766585567
Est. FDRs: 1.0 and 0.009998706023168172
saving plot to figures/laplace_5.png
Got 3395 coords
On task task6
Computing windowed sums
Computing threshold
peak(mu)= 0.3653719309635215
Mu: 3.653719e-01 +/- 1.491312e-05
Lablace_b: 0.3325856575615155 and 1.1418147619314896
Thresholds: -3.518688901200552 and 10.55866134725511
#fdrs pass: 0 and 46541
CDFs: 0.999991524894158 and 0.9998672802311636
Est. FDRs: 1.0 and 0.00999947256953947
saving plot to figures/laplace_6.png
Got 3267 coords
On task task7
Computing windowed sums
Computing threshold
peak(mu)= 0.21681339147381368
Mu: 2.168134e-01 +/- 1.622956e-05
Lablace_b: 0.3013366604974877 and 1.2843711670606777
Thresholds: -3.6860833537430153 and 11.848568329587579
#fdrs pass: 0 and 42773
CDFs: 0.9999976284053004 and 0.9998833556780382
Est. FDRs: 1.0 and 0.009999644225442429
saving plot to figures/laplace_7.png
Got 3087 coords
On task task8
Computing windowed sums
Computing threshold
peak(mu)= 0.7009503918664646
Mu: 7.009504e-01 +/- 1.337726e-05
Lablace_b: 0.37129244662177463 and 0.7849417877387709
Thresholds: -3.050739262808664 and 7.303215951193124
#fdrs pass: 0 and 68400
CDFs: 0.9999591010463694 and 0.999777626711903
Est. FDRs: 1.0 and 0.009999804909649
saving plot to figures/laplace_8.png
Got 3974 coords
After resolving overlaps, got 4178 seqlets
Across all tasks, the weakest laplace threshold used was: 0.9991716656707381
4178 identified in total
3 activity patterns with support >= 100 out of 19683 possible patterns
Metacluster sizes:  [2961, 1013, 106]
Idx to activities:  {0: '0,0,0,0,1,1,1,1,1', 1: '0,0,0,0,0,1,1,1,1', 2: '0,0,0,1,0,0,0,0,0'}
On metacluster 2
Metacluster size 106
Relevant tasks:  ('task3',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 106
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 0.15 s
Starting affinity matrix computations
Normalization computed in 0.01 s
Cosine similarity mat computed in 0.03 s
Normalization computed in 0.02 s
Cosine similarity mat computed in 0.03 s
Finished affinity matrix computations in 0.05 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 1.6 s
Launching nearest neighbors affmat calculation job
Job completed in: 1.59 s
(Round 1) Computed affinity matrix on nearest neighbors in 3.27 s
Filtered down to 106 of 106
(Round 1) Retained 106 rows out of 106 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 106 samples in 0.000s...
[t-SNE] Computed neighbors for 106 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.209128
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0101699829102 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    5.9s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   26.3s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   27.4s finished
Louvain completed 200 runs in 28.6952650547 seconds
Wrote graph to binary file in 0.00809097290039 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.769304
Louvain completed 51 runs in 15.7592830658 seconds
Preproc + Louvain took 44.491312027 s
Got 6 clusters after round 1
Counts:
{0: 25, 1: 24, 2: 21, 3: 16, 4: 11, 5: 9}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 25 seqlets
Trimmed 0 out of 25
Aggregating for cluster 1 with 24 seqlets
Trimmed 0 out of 24
Aggregating for cluster 2 with 21 seqlets
Trimmed 0 out of 21
Aggregating for cluster 3 with 16 seqlets
Trimmed 0 out of 16
Aggregating for cluster 4 with 11 seqlets
Trimmed 0 out of 11
Aggregating for cluster 5 with 9 seqlets
Trimmed 0 out of 9
(Round 2) num seqlets: 106
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 0.13 s
Starting affinity matrix computations
Normalization computed in 0.01 s
Cosine similarity mat computed in 0.02 s
Normalization computed in 0.01 s
Cosine similarity mat computed in 0.01 s
Finished affinity matrix computations in 0.04 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.0 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 1.67 s
Launching nearest neighbors affmat calculation job
Job completed in: 1.63 s
(Round 2) Computed affinity matrix on nearest neighbors in 3.38 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 106 samples in 0.000s...
[t-SNE] Computed neighbors for 106 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.204109
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.0177009105682 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    5.4s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   24.8s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   25.7s finished
Louvain completed 200 runs in 26.8408501148 seconds
Wrote graph to binary file in 0.00621700286865 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.765398
Louvain completed 51 runs in 15.9273080826 seconds
Preproc + Louvain took 42.8037111759 s
Got 6 clusters after round 2
Counts:
{0: 25, 1: 23, 2: 20, 3: 17, 4: 12, 5: 9}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 25 seqlets
Trimmed 1 out of 25
Aggregating for cluster 1 with 23 seqlets
Trimmed 1 out of 23
Aggregating for cluster 2 with 20 seqlets
Trimmed 0 out of 20
Aggregating for cluster 3 with 17 seqlets
Trimmed 2 out of 17
Aggregating for cluster 4 with 12 seqlets
Trimmed 0 out of 12
Aggregating for cluster 5 with 9 seqlets
Trimmed 0 out of 9
Got 6 clusters
Splitting into subclusters...
Merging on 6 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 3 with prob 2.755179521276289e-05 and sim 0.9728914409421971
Collapsing 2 & 5 with prob 7.3692833982619695e-06 and sim 0.9681138320025653
Collapsing 0 & 4 with prob 3.2163850195944213e-06 and sim 0.9659305223582626
Collapsing 4 & 5 with prob 1.4451829338349254e-06 and sim 0.9586127041954944
Collapsing 2 & 4 with prob 3.874735316221638e-05 and sim 0.9511493559445093
Collapsing 3 & 4 with prob 4.8605197664722524e-06 and sim 0.9461435216603133
Collapsing 0 & 2 with prob 2.3412346273864165e-05 and sim 0.9452315678491099
Collapsing 1 & 2 with prob 6.639866008571429e-05 and sim 0.9423250476907215
Aborting collapse as 1 & 3 have prob 2.3686590837485977e-08 and sim 0.8217645324855042
Collapsing 3 & 5 with prob 1.1949424366907797e-06 and sim 0.9391863067363797
Collapsing 1 & 4 with prob 7.554137557122677e-05 and sim 0.909889031199687
Aborting collapse as 1 & 3 have prob 2.3686590837485977e-08 and sim 0.8217645324855042
Trimmed 0 out of 39
Trimmed 0 out of 29
Trimmed 0 out of 51
Trimmed 0 out of 80
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 9.336704409767481e-05 and sim 0.9032275036432782
Trimmed 0 out of 102
On merging iteration 3
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 1 patterns after merging
Performing seqlet reassignment
Got 1 patterns after reassignment
Total time taken is 111.93s
On metacluster 1
Metacluster size 1013
Relevant tasks:  ('task5', 'task6', 'task7', 'task8')
Relevant signs:  (1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 1013
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 1.0 s
Starting affinity matrix computations
Normalization computed in 0.25 s
Cosine similarity mat computed in 0.36 s
Normalization computed in 0.27 s
Cosine similarity mat computed in 0.38 s
Finished affinity matrix computations in 0.78 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.05 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 114.85 s
Launching nearest neighbors affmat calculation job
Job completed in: 113.92 s
(Round 1) Computed affinity matrix on nearest neighbors in 234.57 s
Filtered down to 982 of 1013
(Round 1) Retained 982 rows out of 1013 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 982 samples in 0.001s...
[t-SNE] Computed neighbors for 982 samples in 0.018s...
[t-SNE] Computed conditional probabilities for sample 982 / 982
[t-SNE] Mean sigma: 0.200853
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.121380090714 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    6.2s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   27.8s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   28.8s finished
Louvain completed 200 runs in 31.4329929352 seconds
Wrote graph to binary file in 0.440953969955 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.673516
After 3 runs, maximum modularity is Q = 0.676986
After 14 runs, maximum modularity is Q = 0.679245
After 18 runs, maximum modularity is Q = 0.68463
After 23 runs, maximum modularity is Q = 0.688067
Louvain completed 73 runs in 26.0493879318 seconds
Preproc + Louvain took 58.1109170914 s
Got 9 clusters after round 1
Counts:
{0: 177, 1: 170, 2: 166, 3: 117, 4: 98, 5: 75, 6: 66, 7: 57, 8: 56}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 177 seqlets
Trimmed 8 out of 177
Aggregating for cluster 1 with 170 seqlets
Trimmed 40 out of 170
Aggregating for cluster 2 with 166 seqlets
Trimmed 5 out of 166
Aggregating for cluster 3 with 117 seqlets
Trimmed 7 out of 117
Aggregating for cluster 4 with 98 seqlets
Trimmed 7 out of 98
Aggregating for cluster 5 with 75 seqlets
Trimmed 8 out of 75
Aggregating for cluster 6 with 66 seqlets
Trimmed 4 out of 66
Aggregating for cluster 7 with 57 seqlets
Trimmed 5 out of 57
Aggregating for cluster 8 with 56 seqlets
Trimmed 6 out of 56
(Round 2) num seqlets: 892
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 0.99 s
Starting affinity matrix computations
Normalization computed in 0.21 s
Cosine similarity mat computed in 0.32 s
Normalization computed in 0.22 s
Cosine similarity mat computed in 0.31 s
Finished affinity matrix computations in 0.65 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.04 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 172.55 s
Launching nearest neighbors affmat calculation job
Job completed in: 197.03 s
(Round 2) Computed affinity matrix on nearest neighbors in 376.36 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 892 samples in 0.000s...
[t-SNE] Computed neighbors for 892 samples in 0.010s...
[t-SNE] Computed conditional probabilities for sample 892 / 892
[t-SNE] Mean sigma: 0.197102
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.107351064682 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    7.0s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   28.5s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   29.6s finished
Louvain completed 200 runs in 32.221706152 seconds
Wrote graph to binary file in 0.450809001923 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.625567
After 2 runs, maximum modularity is Q = 0.654965
After 8 runs, maximum modularity is Q = 0.666394
After 24 runs, maximum modularity is Q = 0.667723
Louvain completed 74 runs in 25.7092149258 seconds
Preproc + Louvain took 58.5645060539 s
Got 9 clusters after round 2
Counts:
{0: 226, 1: 170, 2: 131, 3: 86, 4: 70, 5: 57, 6: 54, 7: 50, 8: 48}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 226 seqlets
Trimmed 30 out of 226
Aggregating for cluster 1 with 170 seqlets
Trimmed 5 out of 170
Aggregating for cluster 2 with 131 seqlets
Trimmed 11 out of 131
Aggregating for cluster 3 with 86 seqlets
Trimmed 5 out of 86
Aggregating for cluster 4 with 70 seqlets
Trimmed 15 out of 70
Aggregating for cluster 5 with 57 seqlets
Trimmed 14 out of 57
Aggregating for cluster 6 with 54 seqlets
Trimmed 3 out of 54
Aggregating for cluster 7 with 50 seqlets
Trimmed 2 out of 50
Aggregating for cluster 8 with 48 seqlets
Trimmed 6 out of 48
Got 9 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.0478641986847 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00567424
After 6 runs, maximum modularity is Q = 0.00567706
Louvain completed 26 runs in 8.68090891838 seconds
Similarity is 0.91137442661046; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0691890716553 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00550697
After 4 runs, maximum modularity is Q = 0.00550698
After 14 runs, maximum modularity is Q = 0.00550774
Louvain completed 34 runs in 11.9870598316 seconds
Similarity is 0.9336606210830996; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0350120067596 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00570299
After 2 runs, maximum modularity is Q = 0.00575595
Louvain completed 22 runs in 8.67820596695 seconds
Similarity is 0.9380572308380145; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0203330516815 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00414653
After 14 runs, maximum modularity is Q = 0.00418925
Louvain completed 34 runs in 12.9319500923 seconds
Similarity is 0.9126705493976133; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0205159187317 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00318943
After 2 runs, maximum modularity is Q = 0.0032047
Louvain completed 22 runs in 8.52759504318 seconds
Similarity is 0.9353263150747302; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00906109809875 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00449643
Louvain completed 21 runs in 7.84535384178 seconds
Similarity is 0.907900202424458; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0100059509277 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00476052
Louvain completed 21 runs in 7.07041883469 seconds
Similarity is 0.8852670612689246; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00878095626831 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00882205
Louvain completed 21 runs in 7.07472109795 seconds
Similarity is 0.850758758918456; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.00749707221985 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00504538
Louvain completed 21 runs in 6.90417003632 seconds
Similarity is 0.9152844129010431; is_dissimilar is False
Merging on 9 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 1 & 5 with prob 1.7198029795254358e-05 and sim 3.7079717104758485
Collapsing 3 & 5 with prob 7.057574498558874e-06 and sim 3.680170897055713
Collapsing 1 & 8 with prob 7.98179358349821e-05 and sim 3.6533179976925623
Collapsing 0 & 6 with prob 8.967266875007532e-06 and sim 3.6348999144692495
Collapsing 0 & 5 with prob 7.95026666552125e-06 and sim 3.6019959276202673
Aborting collapse as 0 & 8 have prob 2.374159003063632e-06 and sim 3.2798434781188806
Aborting collapse as 1 & 6 have prob 2.1375375285663527e-08 and sim 2.850278804563171
Aborting collapse as 3 & 6 have prob 5.471879715780886e-08 and sim 3.435978900978409
Aborting collapse as 5 & 6 have prob 2.997738227361316e-08 and sim 3.324724129024806
Aborting collapse as 6 & 8 have prob 3.056985813448783e-08 and sim 2.7318131293585255
Collapsing 0 & 1 with prob 0.0002949873008179631 and sim 3.5057832219790486
Aborting collapse as 0 & 8 have prob 2.374159003063632e-06 and sim 3.2798434781188806
Aborting collapse as 1 & 6 have prob 2.1375375285663527e-08 and sim 2.850278804563171
Aborting collapse as 3 & 6 have prob 5.471879715780886e-08 and sim 3.435978900978409
Aborting collapse as 5 & 6 have prob 2.997738227361316e-08 and sim 3.324724129024806
Aborting collapse as 6 & 8 have prob 3.056985813448783e-08 and sim 2.7318131293585255
Trimmed 0 out of 208
Trimmed 0 out of 289
Trimmed 0 out of 331
Trimmed 0 out of 247
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 0.003275928549394569 and sim 3.5822763799113697
Collapsing 0 & 2 with prob 6.934761601419384e-05 and sim 3.557582810430875
Aborting collapse as 1 & 2 have prob 5.2998115800227265e-06 and sim 3.0202695186495627
Trimmed 0 out of 578
On merging iteration 3
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 2 with prob 4.371669684313125e-06 and sim 3.634867789546491
Trimmed 0 out of 633
On merging iteration 4
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 3 patterns after merging
Performing seqlet reassignment
Got 3 patterns after reassignment
Total time taken is 868.44s
On metacluster 0
Metacluster size 2961
Relevant tasks:  ('task4', 'task5', 'task6', 'task7', 'task8')
Relevant signs:  (1, 1, 1, 1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 2961
(Round 1) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 3.05 s
Starting affinity matrix computations
Normalization computed in 0.73 s
Cosine similarity mat computed in 1.54 s
Normalization computed in 0.76 s
Cosine similarity mat computed in 1.39 s
Finished affinity matrix computations in 3.04 s
(Round 1) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.25 s
(Round 1) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 546.68 s
Launching nearest neighbors affmat calculation job
Job completed in: 514.4 s
(Round 1) Computed affinity matrix on nearest neighbors in 1083.85 s
Filtered down to 2949 of 2961
(Round 1) Retained 2949 rows out of 2961 after filtering
(Round 1) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 2949 samples in 0.006s...
[t-SNE] Computed neighbors for 2949 samples in 0.089s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2949
[t-SNE] Computed conditional probabilities for sample 2000 / 2949
[t-SNE] Computed conditional probabilities for sample 2949 / 2949
[t-SNE] Mean sigma: 0.176896
(Round 1) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.209708929062 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    7.1s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   30.4s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   31.7s finished
Louvain completed 200 runs in 38.7102019787 seconds
Wrote graph to binary file in 2.66251087189 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.704804
After 2 runs, maximum modularity is Q = 0.705865
Louvain completed 52 runs in 27.9412069321 seconds
Preproc + Louvain took 70.0262889862 s
Got 7 clusters after round 1
Counts:
{0: 654, 1: 455, 2: 454, 3: 432, 4: 424, 5: 402, 6: 128}
(Round 1) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 654 seqlets
Trimmed 24 out of 654
Aggregating for cluster 1 with 455 seqlets
Trimmed 12 out of 455
Aggregating for cluster 2 with 454 seqlets
Trimmed 20 out of 454
Aggregating for cluster 3 with 432 seqlets
Trimmed 12 out of 432
Aggregating for cluster 4 with 424 seqlets
Trimmed 18 out of 424
Aggregating for cluster 5 with 402 seqlets
Trimmed 2 out of 402
Aggregating for cluster 6 with 128 seqlets
Trimmed 2 out of 128
(Round 2) num seqlets: 2859
(Round 2) Computing coarse affmat
Beginning embedding computation
Computing embeddings
Finished embedding computation in 3.26 s
Starting affinity matrix computations
Normalization computed in 0.73 s
Cosine similarity mat computed in 1.46 s
Normalization computed in 0.72 s
Cosine similarity mat computed in 1.44 s
Finished affinity matrix computations in 3.01 s
(Round 2) Compute nearest neighbors from coarse affmat
Computed nearest neighbors in 0.19 s
(Round 2) Computing affinity matrix on nearest neighbors
Launching nearest neighbors affmat calculation job
Job completed in: 945.08 s
Launching nearest neighbors affmat calculation job
Job completed in: 892.95 s
(Round 2) Computed affinity matrix on nearest neighbors in 1864.98 s
Not applying filtering for rounds above first round
(Round 2) Computing density adapted affmat
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 2859 samples in 0.006s...
[t-SNE] Computed neighbors for 2859 samples in 0.083s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2859
[t-SNE] Computed conditional probabilities for sample 2000 / 2859
[t-SNE] Computed conditional probabilities for sample 2859 / 2859
[t-SNE] Mean sigma: 0.175551
(Round 2) Computing clustering
Beginning preprocessing + Louvain
Wrote graph to binary file in 0.260280132294 seconds
Running Louvain modularity optimization
[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    8.2s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   33.6s
[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:   34.8s finished
Louvain completed 200 runs in 43.0317549706 seconds
Wrote graph to binary file in 2.88688492775 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.730787
After 43 runs, maximum modularity is Q = 0.731899
After 63 runs, maximum modularity is Q = 0.731901
Louvain completed 113 runs in 61.1023471355 seconds
Preproc + Louvain took 107.766394854 s
Got 8 clusters after round 2
Counts:
{0: 628, 1: 493, 2: 492, 3: 366, 4: 361, 5: 238, 6: 165, 7: 116}
(Round 2) Aggregating seqlets in each cluster
Aggregating for cluster 0 with 628 seqlets
Trimmed 2 out of 628
Aggregating for cluster 1 with 493 seqlets
Trimmed 4 out of 493
Aggregating for cluster 2 with 492 seqlets
Trimmed 4 out of 492
Aggregating for cluster 3 with 366 seqlets
Trimmed 1 out of 366
Aggregating for cluster 4 with 361 seqlets
Trimmed 4 out of 361
Aggregating for cluster 5 with 238 seqlets
Trimmed 15 out of 238
Aggregating for cluster 6 with 165 seqlets
Trimmed 10 out of 165
Aggregating for cluster 7 with 116 seqlets
Trimmed 20 out of 116
Got 8 clusters
Splitting into subclusters...
Inspecting for spurious merging
Wrote graph to binary file in 0.548336029053 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00474882
After 2 runs, maximum modularity is Q = 0.00475129
After 6 runs, maximum modularity is Q = 0.0047518
Louvain completed 26 runs in 11.920388937 seconds
Similarity is 0.9572173007591058; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.404554843903 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00464568
Louvain completed 21 runs in 8.63609981537 seconds
Similarity is 0.9570324743924178; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.431499958038 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00520114
Louvain completed 21 runs in 8.55135512352 seconds
Similarity is 0.941682324547123; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.267559051514 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.0064078
Louvain completed 21 runs in 8.27615809441 seconds
Similarity is 0.9214798390869603; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.24551987648 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00468432
Louvain completed 21 runs in 8.95038199425 seconds
Similarity is 0.9587836256098866; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.104200839996 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00687821
After 17 runs, maximum modularity is Q = 0.00687822
Louvain completed 37 runs in 14.2262330055 seconds
Similarity is 0.9289641279867457; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.050418138504 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00523321
Louvain completed 21 runs in 7.97296309471 seconds
Similarity is 0.9493047414284825; is_dissimilar is False
Inspecting for spurious merging
Wrote graph to binary file in 0.0188150405884 seconds
Running Louvain modularity optimization
After 1 runs, maximum modularity is Q = 0.00880403
After 3 runs, maximum modularity is Q = 0.00885493
After 11 runs, maximum modularity is Q = 0.00885494
Louvain completed 31 runs in 11.9070780277 seconds
Similarity is 0.8845052985559055; is_dissimilar is False
Merging on 8 clusters
On merging iteration 1
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 1 & 4 with prob 0.000396979475081684 and sim 4.973847867939828
Collapsing 0 & 4 with prob 0.0005106273128772062 and sim 4.692208502365131
Collapsing 5 & 6 with prob 5.376493736849311e-06 and sim 4.686355476896804
Collapsing 0 & 1 with prob 0.0019120043801931193 and sim 4.6565329325559945
Collapsing 2 & 3 with prob 0.001797969534898525 and sim 4.6453743149888895
Collapsing 2 & 4 with prob 5.275124147133391e-05 and sim 4.631539620373054
Collapsing 1 & 2 with prob 0.0012693948786884303 and sim 4.629547031539975
Collapsing 2 & 6 with prob 7.084953511941183e-05 and sim 4.59758248390174
Aborting collapse as 0 & 6 have prob 3.9386462478594673e-07 and sim 3.849528206446712
Collapsing 3 & 5 with prob 5.8076511217647525e-06 and sim 4.58678751005867
Aborting collapse as 0 & 6 have prob 3.9386462478594673e-07 and sim 3.849528206446712
Collapsing 0 & 3 with prob 0.0007208024435590315 and sim 4.540225756955814
Collapsing 3 & 6 with prob 2.9714888664524235e-05 and sim 4.529333642596646
Aborting collapse as 0 & 6 have prob 3.9386462478594673e-07 and sim 3.849528206446712
Collapsing 0 & 2 with prob 0.00019401648421666978 and sim 4.34351711631107
Trimmed 0 out of 846
Trimmed 0 out of 1472
Trimmed 0 out of 378
Trimmed 0 out of 853
Trimmed 0 out of 2325
On merging iteration 2
Computing pattern to seqlet distances
Computing pattern to pattern distances
Collapsing 0 & 1 with prob 0.00044071469661547286 and sim 4.572941837921004
Trimmed 0 out of 2703
On merging iteration 3
Computing pattern to seqlet distances
Computing pattern to pattern distances
Got 2 patterns after merging
Performing seqlet reassignment
Got 2 patterns after reassignment
Total time taken is 3371.89s
2018-08-23 22:25:52 DEBUG **************** workflow done *********************
2018-08-23 22:25:53 DEBUG **************** result saved *********************
